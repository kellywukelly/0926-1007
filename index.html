<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†°å³¶æ—…ç¨‹äº’å‹•å„€è¡¨æ¿ (æœ€çµ‚æ•´åˆç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Slate & Sky (Background: slate-50, Text: slate-700, Accent: sky-600, Highlight: amber-500) -->
    <!-- Application Structure Plan: A single-page dashboard combining the best of previous versions. It uses a three-tab main navigation: "èˆªç­ç¸½è¦½" (Flight Overview), "è¡Œç¨‹æ™‚é–“è»¸" (Itinerary Timeline), and "è¦åŠƒèˆ‡æº–å‚™" (Planning & Prep). The "Flight Overview" tab isolates flight details. The "Itinerary Timeline" tab becomes the centerpiece, displaying the detailed vertical timeline for a chronological step-by-step view of the trip. The "Planning & Prep" tab consolidates all tools and auxiliary information (cost summary, assistants, important notes, car rental info). This structure provides the most logical separation of concerns for a user: checking travel logistics, following the day-to-day plan, and accessing preparation materials are three distinct user tasks, now mapped to three main tabs. -->
    <!-- Visualization & Content Choices: Itinerary Data -> Goal: Organize/Follow -> Viz: Vertical Timeline with event cards. Interaction: Clickable links for external maps. Justification: Best reflects the user's detailed chronological plan. Flight Data -> Goal: Inform -> Viz: Flight cards. Justification: Clear and structured display. Prep Info -> Goal: Inform/Assist -> Viz: Styled cards and modal-triggered assistants. Justification: Groups tools and reference material logically. Library/Method: Vanilla JS, Tailwind. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', 'PingFang TC', 'Microsoft JhengHei', sans-serif; }
        .main-tab-active { color: #0284c7; border-color: #0284c7; }
        .main-tab-inactive { color: #475569; border-color: transparent; }
        .timeline-container::before {
            content: ''; position: absolute; left: 50%; transform: translateX(-50%);
            top: 0; bottom: 0; width: 4px; background-color: #e2e8f0; border-radius: 2px;
        }
        .timeline-item { position: relative; width: 50%; }
        .timeline-item:nth-child(odd) { left: 0; padding-right: 2rem; text-align: right; }
        .timeline-item:nth-child(even) { left: 50%; padding-left: 2rem; text-align: left; }
        .timeline-dot {
            position: absolute; top: 0.25rem; left: 50%; transform: translateX(-50%);
            width: 1.25rem; height: 1.25rem; border-radius: 9999px; background-color: #fff; border: 4px solid #e2e8f0;
        }
        .timeline-item:nth-child(odd) .timeline-content { float: right; }
        .timeline-item:nth-child(even) .timeline-content { float: left; }
        .modal { transition: opacity 0.25s ease; }
        .modal-content { transition: transform 0.25s ease; }
        .todo-item.completed span { text-decoration: line-through; color: #94a3b8; }

        @media (max-width: 768px) {
            .timeline-container::before { left: 1.25rem; transform: translateX(-50%); }
            .timeline-item, .timeline-item:nth-child(even) { width: 100%; left: 0; padding-left: 3rem; padding-right: 0; text-align: left; }
            .timeline-dot { left: 1.25rem; }
            .timeline-item:nth-child(odd) .timeline-content, .timeline-item:nth-child(even) .timeline-content { float: none; }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-12 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-sky-700">å†°å³¶æ—…ç¨‹äº’å‹•å„€è¡¨æ¿</h1>
            <p class="text-slate-600 mt-2">æ‚¨çš„å°ˆå±¬èˆªç­ã€æ™‚é–“è»¸èˆ‡è¦åŠƒå·¥å…·</p>
        </header>

        <!-- Main Tabs Navigation -->
        <div class="mb-8 border-b border-slate-300">
            <nav class="-mb-px flex space-x-2 sm:space-x-6 justify-center" aria-label="Main Tabs">
                <button data-tab="flights" class="main-tab-inactive whitespace-nowrap py-3 px-3 sm:px-4 border-b-2 font-semibold text-sm sm:text-base focus:outline-none">âœˆï¸ èˆªç­ç¸½è¦½</button>
                <button data-tab="timeline" class="main-tab-active whitespace-nowrap py-3 px-3 sm:px-4 border-b-2 font-semibold text-sm sm:text-base focus:outline-none">ğŸ—ºï¸ è¡Œç¨‹æ™‚é–“è»¸</button>
                <button data-tab="prep" class="main-tab-inactive whitespace-nowrap py-3 px-3 sm:px-4 border-b-2 font-semibold text-sm sm:text-base focus:outline-none">ğŸ› ï¸ è¦åŠƒèˆ‡æº–å‚™</button>
            </nav>
        </div>

        <!-- Main Content Area -->
        <main>
            <!-- Flights Tab -->
            <div id="flights-content" class="tab-panel hidden">
                 <h2 class="text-2xl font-bold text-slate-700 mb-6 text-center">èˆªç­èˆ‡éå¢ƒè³‡è¨Š</h2>
                 <div class="space-y-8">
                    <div>
                        <h3 class="text-xl font-semibold text-sky-700 mb-4 border-l-4 border-sky-500 pl-3">å»ç¨‹èˆªç­</h3>
                        <div id="outbound-flights-container" class="space-y-6"></div>
                    </div>
                     <div>
                        <h3 class="text-xl font-semibold text-sky-700 mb-4 border-l-4 border-sky-500 pl-3">å›ç¨‹èˆªç­</h3>
                        <div id="return-flights-container" class="space-y-6"></div>
                    </div>
                 </div>
            </div>

            <!-- Timeline Tab -->
            <div id="timeline-content" class="tab-panel">
                 <h2 class="text-2xl font-bold text-slate-700 mb-6 text-center">è¡Œç¨‹æ™‚é–“è»¸</h2>
                 <div id="timeline-container" class="relative timeline-container py-8">
                    <!-- Timeline items will be injected here by JavaScript -->
                </div>
            </div>

            <!-- Prep & Info Tab -->
            <div id="prep-content" class="tab-panel hidden">
                <h2 class="text-2xl font-bold text-slate-700 mb-6 text-center">è¦åŠƒèˆ‡æº–å‚™ä¸­å¿ƒ</h2>
                <div class="space-y-8">
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-sky-500">
                        <h3 class="text-xl font-semibold text-sky-700 mb-4">ğŸ“Š è¡Œç¨‹ç¸½è¦½èˆ‡é ä¼°</h3>
                        <div class="space-y-3 text-slate-600">
                            <div><span class="font-medium">é ä¼°æ©Ÿç¥¨ç¸½é‡‘é¡ï¼š</span><strong class="text-orange-600">NTD $41,555</strong></div>
                            <div><span class="font-medium">ç¾åœ‹ç°½è­‰ESTAè²»ç”¨ï¼š</span><strong class="text-orange-600">USD $21</strong></div>
                            <div><span class="font-medium">å»ºè­°è«‹å‡å¤©æ•¸ï¼š</span><strong class="text-sky-600">5å¤©åŠ</strong> (ä¾æ“š9/26ä¸‹åˆå‡ºç™¼ï¼Œ10/7æŠµå°ä¼°ç®—)</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-amber-500">
                        <h3 class="text-xl font-semibold text-amber-700 mb-4">âœ¨ æ—…ç¨‹å°å¹«æ‰‹</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <button id="btn-activity-ideas" class="w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition">ğŸ’¡ æ´»å‹•éˆæ„Ÿ (AI)</button>
                            <button id="btn-packing-list" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition">ğŸ’ æ‰“åŒ…å»ºè­°</button>
                            <button id="btn-todo-list" class="w-full bg-amber-500 hover:bg-amber-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition">ğŸ“‹ å¾…è¾¦æ¸…å–®</button>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-emerald-500">
                        <h3 class="text-xl font-semibold text-emerald-700 mb-4">ğŸ å†°å³¶å¿…è²·ä¼´æ‰‹ç¦®</h3>
                        <div id="souvenirs-container" class="prose prose-slate max-w-none text-slate-600"></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-slate-500">
                        <h3 class="text-xl font-semibold text-slate-700 mb-4">ğŸ“Œ é‡è¦æ³¨æ„äº‹é …</h3>
                        <div id="important-notes-container" class="prose prose-slate max-w-none text-slate-600"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Structure -->
    <div id="general-modal" class="modal fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-white rounded-lg shadow-xl p-6 w-full max-w-lg max-h-[80vh] overflow-y-auto transform scale-95">
            <div class="flex justify-between items-center mb-4 border-b pb-3"><h3 id="modal-title" class="text-xl font-semibold text-sky-700">æ—…ç¨‹å°å¹«æ‰‹</h3><button id="modal-close-btn" class="text-slate-500 hover:text-slate-700 text-2xl font-bold focus:outline-none">&times;</button></div>
            <div id="modal-body" class="mt-4">
                <div id="modal-loading" class="flex flex-col items-center justify-center py-8 hidden"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600"></div><p class="mt-3 text-slate-600">æ­£åœ¨å‘ AI æŸ¥è©¢...</p></div>
                <div id="modal-response" class="prose prose-slate max-w-none text-slate-600"></div>
                <div id="modal-error" class="text-red-600 bg-red-100 p-3 rounded-md hidden"></div>
            </div>
        </div>
    </div>

    <script>
        const tripData = {
            flights: [
                { leg: 'outbound', segment: 1, segmentName: "1. å°ç£ â†’ è¥¿é›…åœ–", airline: "æ˜Ÿå®‡èˆªç©º JX32", origin: { name: "å°ç£æ¡ƒåœ’", code: "TPE", flag: "ğŸ‡¹ğŸ‡¼" }, destination: { name: "è¥¿é›…åœ–å¡”ç§‘é¦¬", code: "SEA", flag: "ğŸ‡ºğŸ‡¸" }, departureDateTime: "2025/09/26 (é€±äº”) æ™šä¸Š 08:10", arrivalDateTime: "2025/09/26 (é€±äº”) ä¸‹åˆ 04:10", cost: "NTD$12648", remarks: "ç›´é£›ã€‚é£›è¡Œæ™‚é–“ç´„11å°æ™‚ã€‚" },
                { leg: 'outbound', segment: 2, segmentName: "2. è¥¿é›…åœ– â†’ å†°å³¶", airline: "å†°å³¶èˆªç©º  FI682", origin: { name: "è¥¿é›…åœ–å¡”ç§‘é¦¬", code: "SEA", flag: "ğŸ‡ºğŸ‡¸" }, destination: { name: "å†°å³¶å‡±å¤«æ‹‰ç¶­å…‹", code: "KEF", flag: "ğŸ‡®ğŸ‡¸" }, departureDateTime: "2025/09/27 (é€±å…­) ä¸‹åˆ 07:00", arrivalDateTime: "2025/09/28 (é€±æ—¥) æ—©ä¸Š 09:25", cost: "USD$257.6", remarks: "ç›´é£›ã€‚é£›è¡Œæ™‚é–“ç´„7.5å°æ™‚ã€‚<br>è¥¿é›…åœ–è½‰æ©Ÿæ™‚é–“ç´„26å°æ™‚50åˆ†ï¼Œéœ€åœ¨è¥¿é›…åœ–éå¤œã€‚" },
                { leg: 'return', segment: 3, segmentName: "3. å†°å³¶ â†’ è¥¿é›…åœ–", airline: "å†°å³¶èˆªç©º FI683", origin: { name: "å†°å³¶å‡±å¤«æ‹‰ç¶­å…‹", code: "KEF", flag: "ğŸ‡®ğŸ‡¸" }, destination: { name: "è¥¿é›…åœ–å¡”ç§‘é¦¬", code: "SEA", flag: "ğŸ‡ºğŸ‡¸" }, departureDateTime: "2025/10/05 (é€±æ—¥) æ™šä¸Š 07:45", arrivalDateTime: "2025/10/05 (é€±æ—¥) æ™šä¸Š 08:40", cost: "ç´„USD$290", remarks: "ç›´é£›ã€‚é£›è¡Œæ™‚é–“ç´„7å°æ™‚55åˆ†é˜ã€‚" },
                { leg: 'return', segment: 4, segmentName: "4. è¥¿é›…åœ– â†’ å°ç£", airline: "æ˜Ÿå®‡èˆªç©º JX31", origin: { name: "è¥¿é›…åœ–å¡”ç§‘é¦¬", code: "SEA", flag: "ğŸ‡ºğŸ‡¸" }, destination: { name: "å°ç£æ¡ƒåœ’", code: "TPE", flag: "ğŸ‡¹ğŸ‡¼" }, departureDateTime: "2025/10/06 (é€±ä¸€) å‡Œæ™¨ 01:15", arrivalDateTime: "2025/10/07 (é€±äºŒ) å‡Œæ™¨ 04:55", cost: "NTD$11168", remarks: "ç›´é£›ã€‚é£›è¡Œæ™‚é–“ç´„12å°æ™‚40åˆ†ã€‚<br>è¥¿é›…åœ–è½‰æ©Ÿæ™‚é–“ç´„4å°æ™‚35åˆ†é˜ã€‚<br>10/7å‡Œæ™¨æŠµå°ï¼Œç•¶æ—¥éœ€ä¸Šç­ï¼Œå¯è‡ªè¡Œè«‹å‡ï¼Œè«‹æ³¨æ„ä¼‘æ¯ã€‚" }
            ],
            timeline: [
                { type: 'day_header', date: '2025/09/26 (äº”)', dayLabel: 'Day 1', title: 'å•Ÿç¨‹æ—¥', events: [{ time: '20:10', type: 'flight', description: 'å°ç£æ¡ƒåœ’ (TPE) å‡ºç™¼', details: 'æ­ä¹˜æ˜Ÿå®‡èˆªç©ºå‰å¾€è¥¿é›…åœ–ã€‚' }, { time: '16:10', type: 'flight_arrival', description: 'æŠµé”è¥¿é›…åœ– (SEA)', details: 'è¾¦ç†å…¥å¢ƒæ‰‹çºŒã€‚' }, { time: 'å‚æ™š', type: 'stay', description: 'è¥¿é›…åœ–ä½å®¿', details: 'åœ¨è¥¿é›…åœ–éå¤œï¼Œç‚ºéš”å¤©èˆªç­åšæº–å‚™ã€‚' }] },
                { type: 'day_header', date: '2025/09/27 (å…­)', dayLabel: 'Day 2', title: 'è¥¿é›…åœ–è½‰æ©Ÿ', events: [{ time: 'ç™½å¤©', type: 'activity', description: 'è¥¿é›…åœ–è‡ªç”±æ´»å‹•', details: 'å¯é€²è¡Œå¸‚å€è§€å…‰æˆ–ä¼‘æ¯ã€‚' }, { time: '19:00', type: 'flight', description: 'è¥¿é›…åœ– (SEA) å‡ºç™¼', details: 'æ­ä¹˜å†°å³¶èˆªç©ºé£›å¾€å†°å³¶ (KEF)ã€‚' }] },
                { type: 'day_header', date: '2025/09/28 (æ—¥)', dayLabel: 'å†°å³¶ Day 1', title: 'é»ƒé‡‘åœˆåˆæ¢', events: [{ time: '09:25', type: 'flight_arrival', description: 'æŠµé”å†°å³¶ (KEF)', details: 'é è¨ˆè‡³ 12:00 å®Œæˆå‡ºå¢ƒèˆ‡ç§Ÿè»Šæ‰‹çºŒã€‚<br>ç­‰è¡Œææ™‚ï¼Œå¯å»è¡Œæè¼¸é€å¸¶æ—é‚Šçš„Duty Free Shopè²·é…’ã€‚' }, { time: '12:00-13:30', type: 'drive', description: 'é–‹è»Šè‡³é»ƒé‡‘åœˆ' }, { time: '13:30-14:00', type: 'activity', description: 'ç«å£æ¹– (KeriÃ°)', link: 'https://maps.app.goo.gl/3yQWRJVix1B3RQot5' }, { time: '14:00-14:30', type: 'drive', description: 'è»Šç¨‹' }, { time: '14:30-15:30', type: 'activity', description: 'é–“æ­‡æ³‰ (Strokkur)', link: 'https://maps.app.goo.gl/FcxjjY2f3CYD7sHd9' }, { time: '15:30-15:50', type: 'drive', description: 'è»Šç¨‹' }, { time: '15:50-17:00', type: 'activity', description: 'å¤ä½›æ–¯ç€‘å¸ƒ (Gullfoss)', link: 'https://maps.app.goo.gl/Fd6PuqHVP4ySK8EYA' }, { time: '17:00-18:00', type: 'drive', description: 'å‰å¾€éœçˆ¾æ–¯æ²ƒå¾·å‘‚çˆ¾' }, { time: '18:00-19:00', type: 'food', description: 'è¶…å¸‚æ¡è²·', details: 'KrÃ³nan è¶…å¸‚ï¼Œç‡Ÿæ¥­è‡³ 19:00ã€‚', link: 'https://maps.app.goo.gl/KGzob8RwEsHaoVhW9' }, { time: '19:00 å¾Œ', type: 'stay', description: 'å…¥ä½ Asgard', details: 'åœ°å€: QQ2Q+FJ2, 860 HvolsvÃ¶llur, å†°å³¶', link: 'https://www.google.com/maps/search/?api=1&query=Asgard, QQ2Q%2BFJ2, 860 HvolsvÃ¶llur, Iceland' }] },
                { type: 'day_header', date: '2025/09/29 (ä¸€)', dayLabel: 'å†°å³¶ Day 2', title: 'å—éƒ¨æµ·å²¸è‡³å†°æ²³æ¹–', events: [{ time: '07:00-07:40', type: 'drive', description: 'è»Šç¨‹' }, { time: '07:40-08:30', type: 'activity', description: 'æ–¯ç§‘åŠ çˆ¾ç€‘å¸ƒ (å½©è™¹ç€‘å¸ƒ)', link: 'https://maps.app.goo.gl/yzs3pgweuAQQtuFJ9' }, { time: '08:30-09:00', type: 'drive', description: 'è»Šç¨‹' }, { time: '09:00-10:00', type: 'activity', description: 'é»‘æ²™ç˜ (Reynisfjara)', details: 'æ³¨æ„ç˜‹ç‹—æµªï¼', link: 'https://maps.app.goo.gl/fzRPSic7vYCnnX4D6' }, { time: '10:00-12:00', type: 'food', description: 'ç¶­å…‹é® (VÃ­k) ç”¨é¤èˆ‡æ¡è²·' }, { time: '12:00-14:30', type: 'drive', description: 'é•·é€”é§•é§›è‡³å†°æ²³æ¹–' }, { time: '14:30-18:00', type: 'activity', description: 'å‚‘å¤æ²™é¾å†°æ²³æ¹– & é‘½çŸ³å†°æ²™ç˜', link: 'https://maps.app.goo.gl/7UjcUFshiA9x5tBF7' }, { time: '18:00-18:30', type: 'drive', description: 'å‰å¾€ä½å®¿é»' }, { time: '18:30 å¾Œ', type: 'stay', description: 'å…¥ä½ Vagnsstadir Guesthouse', details: 'åœ°å€: F985, 781 hornafjordur, å†°å³¶', link: 'https://www.google.com/maps/search/?api=1&query=Vagnsstadir+Guesthouse' }] },
                { type: 'day_header', date: '2025/09/30 (äºŒ)', dayLabel: 'å†°å³¶ Day 3', title: 'å†°ä¸Šæ´»å‹•èˆ‡æ±éƒ¨å³½ç£', events: [{ time: '07:00-09:30', type: 'prep', description: 'èµ·åºŠã€æ—©é¤ã€å‰å¾€æ´»å‹•é»' }, { time: '09:30-12:30', type: 'activity', description: 'å†°ä¸Šæ‘©æ‰˜è»Š' }, { time: '12:30-13:30', type: 'drive', description: 'è»Šç¨‹è‡³èµ«æœ¬é®' }, { time: '13:30-15:00', type: 'food', description: 'èµ«æœ¬é® (HÃ¶fn) ç”¨é¤' }, { time: '15:00-15:30', type: 'drive', description: 'è»Šç¨‹è‡³è™è å±±' }, { time: '15:30-17:00', type: 'activity', description: 'è™è å±± (Vestrahorn) & ç¶­äº¬éƒ¨è½', link: 'https://maps.app.goo.gl/AMCdonBKBpgXUYTj8' }, { time: '17:00-19:00', type: 'drive', description: 'é•·é€”é§•é§›è‡³ä½å®¿é»' }, { time: '19:00 å¾Œ', type: 'stay', description: 'å…¥ä½ Berunes HI Hostel', link: 'https://maps.app.goo.gl/79GzisudzJVPZCh16' }] },
                { type: 'day_header', date: '2025/10/01 (ä¸‰)', dayLabel: 'å†°å³¶ Day 4', title: 'æ±éƒ¨å³½ç£è‡³ç±³æ¹–', events: [{ time: '09:00-11:00', type: 'drive', description: 'è»Šç¨‹' }, { time: '11:00-11:30', type: 'activity', description: 'å¤å¤«ç€‘å¸ƒ (Gufufoss)' }, { time: '11:30-11:50', type: 'drive', description: 'è»Šç¨‹' }, { time: '11:50-15:00', type: 'food', description: 'å¡æ¿Ÿæ–¯è²å„æ¾¤ (ç™½æ—¥å¤¢å†’éšªå°é®)' }, { time: '15:00-15:30', type: 'drive', description: 'è»Šç¨‹' }, { time: '15:30-16:30', type: 'food', description: 'åŸƒä¼Šçˆ¾æ–¯å¡”æ¿Ÿæ¡è²·' }, { time: '16:30-18:30', type: 'drive', description: 'é•·é€”é§•é§›è‡³ç±³æ¹–' }, { time: '18:30 å¾Œ', type: 'stay', description: 'å…¥ä½ Dimmuborgir Guesthouse', link: 'https://maps.app.goo.gl/hzB53wA4CKcWUkwx8' }] },
                { type: 'day_header', date: '2025/10/02 (å››)', dayLabel: 'å†°å³¶ Day 5', title: 'ç±³æ¹–å€åŸŸæ¢ç´¢', events: [{ time: 'ä¸Šåˆ', type: 'activity', description: 'ç¹ç±³æ¹– & èµ°æ­¥é“', link: 'https://maps.app.goo.gl/p6ecqwxLjtnwrCxJ7' }, { time: '09:10-09:20', type: 'activity', description: 'åœ°æ´æº«æ³‰ (GrjÃ³tagjÃ¡)', link: 'https://maps.app.goo.gl/cu6Lo7FwHhK747ey5' }, { time: '09:30-09:50', type: 'activity', description: 'åœ°ç†±è°· (Hverir)' , link: 'https://maps.app.goo.gl/nSKUtBTJnxYfJfTt9'}, { time: '10:00-12:30', type: 'activity', description: 'ç±³æ¹–æº«æ³‰â™¨ï¸ + ç°¡å–®åˆé¤' }, { time: '12:30-13:20', type: 'drive', description: 'è»Šç¨‹' }, { time: '13:20-15:40', type: 'activity', description: 'çœ¾ç¥ç€‘å¸ƒ (GoÃ°afoss)', link: 'https://maps.app.goo.gl/mykfQy7o293bruMn9' }, { time: '15:40-16:10', type: 'drive', description: 'è»Šç¨‹' }, { time: '16:10-16:30', type: 'food', description: 'äºåº«ä¾†æ­·å°è±¬è¶…å¸‚æ¡è²·', link: 'https://maps.app.goo.gl/LoQN8z2PVeY7p1Qm6' }, { time: 'æ™šä¸Š', type: 'stay', description: 'å°‹æ‰¾ä½å®¿é»', details: 'å¯è€ƒæ…®åœ¨äºåº«ä¾†æ­·(Akureyri)æˆ–å¾€è¥¿æ²¿é€”å°‹æ‰¾ä½å®¿ã€‚' }] },
                { type: 'day_header', date: '2025/10/03 (äº”)', dayLabel: 'å†°å³¶ Day 6', title: 'ç«å±±æ¢éšªèˆ‡å‰å¾€æ–¯å¥ˆå±±', events: [{ time: '08:00-11:30', type: 'drive', description: 'å¾åŒ—éƒ¨ä½å®¿é»å‡ºç™¼', details: 'é©…è»Šå‰å¾€VÃ­Ã°gelmirç†”å²©æ´ç©´ã€‚'},{ time: '11:30-13:00', type: 'activity', description: 'HellaferÃ° Ã­ VÃ­Ã°gelmi ç«å±±å…§éƒ¨æ¢éšª', details: 'åƒåŠ é ç´„çš„ç†”å²©æ´ç©´å°è¦½ã€‚'},{ time: '13:00-14:00', type: 'food', description: 'åˆé¤', details: 'åœ¨é™„è¿‘(å¦‚HÃºsafell)æˆ–æ²¿é€”ç”¨é¤ã€‚'},{ time: '14:00-16:30', type: 'drive', description: 'å‰å¾€æ–¯å¥ˆå±±åŠå³¶', details: 'é©…è»Šå‰å¾€æ•™æœƒå±±é™„è¿‘çš„ä½å®¿é»ã€‚'},{ time: 'å‚æ™š', type: 'stay', description: 'å…¥ä½æ•™æœƒå±±é™„è¿‘', details: 'ä¾‹å¦‚æ ¼å€«é”è²å„æ¾¤(GrundarfjÃ¶rÃ°ur)æˆ–æ­æ‹‰å¤«æ–¯ç¶­å…‹(Ã“lafsvÃ­k)ã€‚'}]},
                { type: 'day_header', date: '2025/10/04 (å…­)', dayLabel: 'å†°å³¶ Day 7', title: 'æ–¯å¥ˆå±±åŠå³¶ä¹‹æ—… & è¿”å›é¦–éƒ½', events: [{ time: '09:30-10:30', type: 'activity', description: 'æ•™æœƒå±± (Kirkjufell)', link: 'https://maps.app.goo.gl/dT24ip891wvGLQgA6' }, { time: '11:00-11:30', type: 'activity', description: 'IngjaldshÃ³ll Church (å°ç´…å±‹)', link: 'https://maps.app.goo.gl/cmZkqnLourWXGbZXA' }, { time: '11:45-13:30', type: 'food', description: 'æ­æ‹‰å¤«æ–¯ç¶­å…‹ (Ã“lafsvÃ­k) åˆé¤', link: 'https://maps.app.goo.gl/xGPTWHffmCDdEWMP7' }, { time: '13:50-14:00', type: 'activity', description: 'é»‘æ•™å ‚ (BÃºÃ°akirkja)', link: 'https://maps.app.goo.gl/P3tvTXq1piaSSNhN9' }, { time: '14:20-15:30', type: 'activity', description: 'æµ·è±¹æ²™ç˜ (Ytri Tunga)', link: 'https://maps.app.goo.gl/8tq33ZHYoBwtqRw9A' }, { time: '15:30-17:30', type: 'drive', description: 'é•·é€”é§•é§›è‡³é¦–éƒ½' }, { time: '17:30 å¾Œ', type: 'stay', description: 'å…¥ä½é›·å…‹é›…ç¶­å…‹' }] },
                { type: 'day_header', date: '2025/10/05 (æ—¥)', dayLabel: 'å†°å³¶ Day 8', title: 'é¦–éƒ½è§€å…‰ & æ­¸é€”', events: [{time: 'ä¸Šåˆ', type: 'activity', description: 'é›·å…‹é›…ç¶­å…‹å¸‚å€è§€å…‰', details: 'åƒè§€å“ˆçˆ¾æ ¼æ—å§†æ•™å ‚ã€åœ¨å¸‚å€æ¼«æ­¥ã€‚'}, {time: 'ä¸­åˆ', type: 'food', description: 'BÃ¦jarins Beztu Pylsur ç†±ç‹—æ”¤'}, {time: 'ä¸‹åˆ', type: 'activity', description: 'å¤©ç©ºæ½Ÿæ¹– (Sky Lagoon)', details: 'äº«å—æº«æ³‰ï¼Œæ”¾é¬†èº«å¿ƒã€‚'}, { time: '19:45', type: 'flight', description: 'å¾å†°å³¶ (KEF) å‡ºç™¼', details: 'æ­ä¹˜å†°å³¶èˆªç©ºè¿”å›è¥¿é›…åœ–ã€‚' }] },
            ],
            importantNotes: [
                { type: 'text', content: 'ç°½è­‰èˆ‡è­·ç…§ï¼šè«‹å‹™å¿…ç¢ºèªæ‚¨çš„è­·ç…§æ•ˆæœŸï¼ˆé€šå¸¸å»ºè­°è¡Œç¨‹çµæŸå¾Œä»æœ‰6å€‹æœˆä»¥ä¸Šæ•ˆæœŸï¼‰ï¼Œä¸¦æå‰è¾¦ç†æ‰€éœ€ç°½è­‰ï¼ˆç¾åœ‹ESTAåŠç”³æ ¹ç°½è­‰ï¼‰ã€‚'},
                { type: "voltage_plug", text: "é›»å£“èˆ‡æ’åº§ï¼šå†°å³¶çš„æ¨™æº–é›»å£“ç‚º 230Vï¼Œé »ç‡ç‚º 50Hzã€‚æ’åº§é¡å‹ç‚º F å‹ï¼ˆé›™åœ“å­”ï¼‰ï¼Œéœ€è¦æº–å‚™è½‰æ¥é ­ã€‚", imageUrl: "https://raw.githubusercontent.com/kellywukelly/0926-1007/main/Steckdose.jpg", imageAlt: "F å‹ (Schuko) æ’åº§èˆ‡æ’é ­ç¤ºæ„åœ–"},
                { type: 'text', content: 'è½‰æ©Ÿï¼šåœ‹éš›è½‰æ©Ÿè«‹é ç•™å……è¶³æ™‚é–“ï¼Œç‰¹åˆ¥æ˜¯ä¸åŒèˆªç©ºå…¬å¸ã€‚'},
                { type: 'text', content: 'ä½å®¿èˆ‡ç•¶åœ°äº¤é€šï¼šåˆ¥å¿˜äº†é è¨‚åœ¨è¥¿é›…åœ–ï¼ˆè‹¥éå¤œï¼‰åŠå†°å³¶çš„ä½å®¿èˆ‡ç•¶åœ°äº¤é€šã€‚'},
                { type: 'text', content: 'æ—…éŠä¿éšªï¼šå¼·çƒˆå»ºè­°è³¼è²·æ—…éŠå¹³å®‰éšªåŠæ—…éŠä¸ä¾¿éšªã€‚'}
            ]
        };
        const icons = { flight: 'âœˆï¸', flight_arrival: 'ğŸ›¬', drive: 'ğŸš—', activity: 'ğŸï¸', food: 'ğŸ½ï¸', stay: 'ğŸ ', prep: 'ğŸ“‹', plan: 'âœï¸' };

        document.addEventListener('DOMContentLoaded', () => {
            const timelineContainer = document.getElementById('timeline-container');
            const outboundFlightsContainer = document.getElementById('outbound-flights-container');
            const returnFlightsContainer = document.getElementById('return-flights-container');
            const notesContainer = document.getElementById('important-notes-container');
            const souvenirsContainer = document.getElementById('souvenirs-container');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const generalModal = document.getElementById('general-modal');

            // Render Timeline
            tripData.timeline.forEach((day) => {
                const dayWrapper = document.createElement('div');
                dayWrapper.className = 'timeline-item mb-8';
                let eventsHTML = day.events.map(event => `
                    <div class="flex items-start space-x-4 py-3 border-b border-slate-100 last:border-b-0">
                        <div class="flex-shrink-0 w-20 text-right font-semibold text-sky-600">${event.time || ''}</div>
                        <div class="flex-shrink-0 text-xl">${icons[event.type] || 'â¡ï¸'}</div>
                        <div class="flex-grow">
                            <p class="font-semibold text-slate-800">${event.description}</p>
                            ${event.details ? `<p class="text-sm text-slate-500 mt-1">${event.details}</p>` : ''}
                            ${event.link ? `<a href="${event.link}" target="_blank" rel="noopener noreferrer" class="inline-block mt-2 text-xs bg-sky-100 text-sky-700 font-semibold px-3 py-1 rounded-full hover:bg-sky-200 transition">ğŸ“ åœ¨åœ°åœ–ä¸ŠæŸ¥çœ‹</a>` : ''}
                        </div>
                    </div>`).join('');
                dayWrapper.innerHTML = `
                    <div class="timeline-dot bg-sky-500 border-sky-200"></div>
                    <div class="timeline-content w-full md:w-11/12 lg:w-10/12 bg-white p-4 sm:p-6 rounded-lg shadow-lg border border-slate-200">
                        <div class="flex justify-between items-baseline mb-4">
                            <span class="text-xs font-bold uppercase text-white bg-sky-600 px-2 py-1 rounded-md">${day.dayLabel}</span>
                            <h2 class="text-xl sm:text-2xl font-bold text-slate-800">${day.title}</h2>
                            <time class="text-sm font-semibold text-slate-500">${day.date}</time>
                        </div>
                        <div class="space-y-1">${eventsHTML}</div>
                    </div>`;
                timelineContainer.appendChild(dayWrapper);
            });
            
            // Render Flight Cards
            const createFlightCard = (flight) => `<div class="bg-white p-5 sm:p-6 rounded-lg shadow-lg border border-slate-200"><h3 class="text-xl font-semibold text-sky-700 mb-3">${flight.segmentName}</h3><div class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 text-sm text-slate-600"><div><p class="font-medium text-slate-800">âœˆï¸ èˆªç©ºå…¬å¸/èˆªç­ï¼š</p><p>${flight.airline}</p></div><div><p class="font-medium text-slate-800">ğŸ’° é‡‘é¡ (é ä¼°)ï¼š</p><p class="text-orange-600 font-semibold">${flight.cost}</p></div><div class="sm:col-span-2 border-t border-slate-200 pt-4 mt-2"><div class="flex items-center justify-between space-x-4"><div class="text-center flex-1"><p class="text-xs text-slate-500">å‡ºç™¼</p><p class="font-semibold text-lg">${flight.origin.flag} ${flight.origin.code}</p><p class="text-xs">${flight.origin.name}</p><p class="text-xs mt-1">${flight.departureDateTime}</p></div><div class="text-slate-400 text-2xl">â†’</div><div class="text-center flex-1"><p class="text-xs text-slate-500">æŠµé”</p><p class="font-semibold text-lg">${flight.destination.flag} ${flight.destination.code}</p><p class="text-xs">${flight.destination.name}</p><p class="text-xs mt-1">${flight.arrivalDateTime}</p></div></div></div><div class="sm:col-span-2 mt-2"><p class="font-medium text-slate-800">ğŸ“ å‚™è¨»ï¼š</p><p class="prose prose-sm max-w-none">${flight.remarks.replace(/<br>/g, '<br>')}</p></div></div></div>`;
            outboundFlightsContainer.innerHTML = tripData.flights.filter(f => f.leg === 'outbound').map(createFlightCard).join('');
            returnFlightsContainer.innerHTML = tripData.flights.filter(f => f.leg === 'return').map(createFlightCard).join('');

            // Render Important Notes
            const notesUl = document.createElement('ul');
            notesUl.className = "list-disc pl-5 space-y-4";
            tripData.importantNotes.forEach(note => {
                const li = document.createElement('li');
                if (note.type === 'voltage_plug') {
                    li.innerHTML = `${note.text} <br><img src="${note.imageUrl}" alt="${note.imageAlt}" class="mt-2 rounded-md shadow-sm max-w-[200px]" onerror="this.onerror=null;this.src='https://placehold.co/200x150/E2E8F0/475569?text=æ’åº§åœ–ç‰‡'">`;
                } else {
                    li.textContent = note.content;
                }
                notesUl.appendChild(li);
            });
            notesContainer.appendChild(notesUl);

            // Render Souvenirs
            souvenirsContainer.innerHTML = `
                <ul class="list-disc pl-5 space-y-3">
                    <li><strong>å†°å³¶ç¾Šæ¯›è¡£ (Lopapeysa)</strong>ï¼šæœ€å…·ä»£è¡¨æ€§çš„ç´€å¿µå“ï¼Œä¿æš–ä¸”æœ‰ç¨ç‰¹åœ–é¨°ã€‚</li>
                    <li><strong>æˆ¶å¤–å“ç‰Œæœé£¾</strong>ï¼šå¦‚ 66Â°Northã€Zo-On ç­‰å†°å³¶æœ¬åœ°å“ç‰Œï¼Œå…¼å…·è¨­è¨ˆèˆ‡åŠŸèƒ½æ€§ã€‚</li>
                    <li><strong>è—æ¹–è­·è†šå“ (Blue Lagoon Skincare)</strong>ï¼šä»¥è—æ¹–çš„çŸ½æ³¥ç‚ºä¸»è¦æˆåˆ†ï¼Œæ˜¯æ¥µå—æ­¡è¿çš„ä¿é¤Šå“ã€‚</li>
                    <li><strong>å·§å…‹åŠ›èˆ‡ç”˜è‰ç³– (LakkrÃ­s)</strong>ï¼šOmnom å·§å…‹åŠ›æ˜¯çŸ¥åå“ç‰Œï¼Œè€Œç”˜è‰ç³–å‰‡æ˜¯å†°å³¶äººçš„åœ‹æ°‘é›¶é£Ÿï¼Œå£å‘³ç‰¹æ®Šï¼Œå€¼å¾—ä¸€è©¦ã€‚</li>
                    <li><strong>Puffin ç›¸é—œå•†å“</strong>ï¼šä»¥å¯æ„›çš„åœ‹é³¥å¸•èŠ¬é³¥ç‚ºä¸»é¡Œçš„å„ç¨®ç©å¶ã€é£¾å“ã€ç´€å¿µå“ã€‚</li>
                    <li><strong>ç«å±±ç†”å²©é£¾å“</strong>ï¼šä½¿ç”¨ç•¶åœ°ç«å±±å²©è£½ä½œçš„é …éŠã€æ‰‹ç’°ç­‰ï¼Œå……æ»¿å†°å³¶ç‰¹è‰²ã€‚</li>
                </ul>`;

            // Tab Switching Logic
            const tabs = document.querySelectorAll('[data-tab]');
            const tabPanels = document.querySelectorAll('.tab-panel');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.replace('main-tab-active', 'main-tab-inactive'));
                    tab.classList.replace('main-tab-inactive', 'main-tab-active');
                    tabPanels.forEach(p => p.id === `${tab.dataset.tab}-content` ? p.classList.remove('hidden') : p.classList.add('hidden'));
                });
            });
            document.querySelector('[data-tab="timeline"]').click();
            document.getElementById('currentYear').textContent = new Date().getFullYear();
        });
    </script>
</body>
</html>
